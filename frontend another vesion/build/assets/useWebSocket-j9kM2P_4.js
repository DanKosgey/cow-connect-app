import{r as e}from"./index-C6fZJ48e.js";const E=(d,w={})=>{const{reconnectInterval:S=3e3,maxReconnectAttempts:b=5,onOpen:r,onClose:o,onError:u,onMessage:a}=w,[t,k]=e.useState(null),[i,p]=e.useState(!1),[C,g]=e.useState(null),f=e.useRef(0),n=e.useRef(null),R=e.useRef(!0),l=e.useCallback(()=>{n.current&&(clearTimeout(n.current),n.current=null);const c=new WebSocket(d);c.onopen=()=>{p(!0),g(null),f.current=0,r==null||r()},c.onclose=s=>{p(!1),k(null),R.current&&f.current<b&&(f.current+=1,n.current=setTimeout(()=>{l()},S)),o==null||o()},c.onerror=s=>{g(s),u==null||u(s)},c.onmessage=s=>{try{const m=JSON.parse(s.data);a==null||a(m)}catch(m){console.error("Error parsing WebSocket message:",m)}},k(c)},[d,S,b,r,o,u,a]),W=e.useCallback(()=>{R.current=!1,n.current&&(clearTimeout(n.current),n.current=null),t&&t.close()},[t]),T=e.useCallback(c=>{t&&i?t.send(JSON.stringify(c)):console.warn("WebSocket is not connected. Message not sent.")},[t,i]);return e.useEffect(()=>(l(),()=>{W()}),[l,W]),{ws:t,isConnected:i,error:C,sendMessage:T,reconnect:l}};export{E as u};
