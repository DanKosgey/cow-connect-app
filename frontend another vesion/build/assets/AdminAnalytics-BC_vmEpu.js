import{e as W,r as d,j as e,M as $,b as I,z as v}from"./index-C6fZJ48e.js";import{C as a,a as i,b as l,d as o,c as m}from"./card-D80GW863.js";import{A as z}from"./AdminSidebar-BlxC4_lF.js";import{S as Q,m as J}from"./avatar-BmR-I4hu.js";import{a as U}from"./ApiService-bGFnA_mg.js";import{D as H}from"./dollar-sign-ZMqYMnDH.js";import{T as w}from"./trending-up-DypWr_bi.js";import{C}from"./chart-column-hY8aCTYj.js";import{R as h,L as X,X as M,Y as k,T as y,a as Y,P as V,b as Z,C as _,B as ee,c as se}from"./PieChart-qLQrvWxl.js";import{C as D}from"./CartesianGrid-BVLrOhPa.js";import{C as te}from"./calendar-B8DrZPNE.js";import"./button-CjSaidot.js";import"./sheet-hMc6SWc2.js";import"./index-CrhFojRB.js";import"./Combination-D2BFsl2-.js";import"./bot-CkBzqiOK.js";import"./input-ZoKW3yZy.js";import"./separator-DKBG6nYm.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=W("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]),ve=()=>{var p,f;const[S,G]=d.useState([]),[j,A]=d.useState([]),[R,L]=d.useState([]),[t,O]=d.useState({}),[F,u]=d.useState(!0),[b,P]=d.useState(null);return d.useEffect(()=>{(async()=>{try{u(!0);const s=await U.Analytics.getDashboardStats();O({monthlyCollection:s.monthLiters||0,avgDailyCollection:s.avgDailyCollection||0,monthlyRevenue:s.totalRevenue||0,qualityScore:s.avgQuality||0,bestCollectionDay:s.bestCollectionDay||"N/A",monthOverMonthGrowth:s.monthOverMonthGrowth||0,projectedNextMonth:s.projectedNextMonth||0});const K=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],g=[],T=s.todayLiters||500,B=Math.round((s.totalFarmers||100)*.3);for(let r=0;r<7;r++){const x=.8+Math.random()*.4;g.push({day:K[r],liters:Math.round(T*x*(.8+r*.05)),farmers:Math.round(B*x*(.9+r*.03))})}G(g);const c=s.gradeDistribution||{A:0,B:0,C:0,D:0,F:0};A([{grade:"Grade A",count:c.A||0,color:"#16a34a"},{grade:"Grade B",count:c.B||0,color:"#f59e0b"},{grade:"Grade C",count:c.C||0,color:"#ef4444"},{grade:"Grade D",count:c.D||0,color:"#dc2626"},{grade:"Grade F",count:c.F||0,color:"#991b1b"}]);const q=s.totalRevenue||5e5,N=[],E=["Jan","Feb","Mar","Apr","May","Jun"];for(let r=0;r<6;r++){const x=1+r*.05;N.push({month:E[r],revenue:Math.round(q*x*(.9+Math.random()*.2))})}L(N),v.info("Analytics data fetched successfully")}catch(s){v.error("Error fetching analytics data",s),P("Failed to load analytics data")}finally{u(!1)}})()},[]),F?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):b?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-red-500 text-center",children:e.jsxs("p",{children:["Error loading analytics: ",b]})})}):e.jsx(Q,{children:e.jsxs("div",{className:"min-h-screen flex w-full bg-dairy-50",children:[e.jsx(z,{}),e.jsxs("main",{className:"flex-1 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(J,{className:"border border-dairy-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-dairy-900",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-dairy-600",children:"Comprehensive insights and performance metrics"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs(a,{className:"border-dairy-200",children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium text-dairy-700",children:"Monthly Collection"}),e.jsx($,{className:"h-4 w-4 text-dairy-green"})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"text-2xl font-bold text-dairy-900",children:[t.monthlyCollection,"L"]}),e.jsxs("p",{className:"text-xs text-dairy-600",children:[e.jsxs("span",{className:t.monthOverMonthGrowth>=0?"text-dairy-green":"text-red-500",children:[t.monthOverMonthGrowth>=0?"+":"",t.monthOverMonthGrowth,"%"]})," from last month"]})]})]}),e.jsxs(a,{className:"border-dairy-200",children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium text-dairy-700",children:"Avg Daily Collection"}),e.jsx(I,{className:"h-4 w-4 text-dairy-blue"})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"text-2xl font-bold text-dairy-900",children:[t.avgDailyCollection,"L"]}),e.jsxs("p",{className:"text-xs text-dairy-600",children:[e.jsx("span",{className:"text-dairy-green",children:"+8%"})," this month"]})]})]}),e.jsxs(a,{className:"border-dairy-200",children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium text-dairy-700",children:"Revenue (June)"}),e.jsx(H,{className:"h-4 w-4 text-dairy-amber"})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"text-2xl font-bold text-dairy-900",children:["KSh ",((p=t.monthlyRevenue)==null?void 0:p.toLocaleString())||"0"]}),e.jsxs("p",{className:"text-xs text-dairy-600",children:[e.jsxs("span",{className:t.monthOverMonthGrowth>=0?"text-dairy-green":"text-red-500",children:[t.monthOverMonthGrowth>=0?"+":"",t.monthOverMonthGrowth,"%"]})," from May"]})]})]}),e.jsxs(a,{className:"border-dairy-200",children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium text-dairy-700",children:"Best Collection Day"}),e.jsx(w,{className:"h-4 w-4 text-dairy-green"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold text-dairy-900",children:t.bestCollectionDay}),e.jsx("p",{className:"text-xs text-dairy-600",children:e.jsx("span",{className:"text-dairy-green",children:"Peak Performance"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs(a,{className:"border-dairy-200",children:[e.jsxs(i,{children:[e.jsxs(l,{className:"text-dairy-900 flex items-center",children:[e.jsx(C,{className:"h-5 w-5 mr-2 text-dairy-blue"}),"Weekly Collection Trends"]}),e.jsx(m,{children:"Daily milk collection and farmer participation"})]}),e.jsx(o,{children:e.jsx(h,{width:"100%",height:300,children:e.jsxs(X,{data:S,children:[e.jsx(D,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(M,{dataKey:"day",stroke:"#64748b"}),e.jsx(k,{stroke:"#64748b"}),e.jsx(y,{contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"0.5rem"}}),e.jsx(Y,{type:"monotone",dataKey:"liters",stroke:"#16a34a",strokeWidth:2,dot:{stroke:"#16a34a",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#16a34a",strokeWidth:2}})]})})})]}),e.jsxs(a,{className:"border-dairy-200",children:[e.jsxs(i,{children:[e.jsxs(l,{className:"text-dairy-900 flex items-center",children:[e.jsx(re,{className:"h-5 w-5 mr-2 text-dairy-amber"}),"Quality Grade Distribution"]}),e.jsx(m,{children:"Current milk quality distribution across all collections"})]}),e.jsx(o,{children:e.jsx(h,{width:"100%",height:300,children:e.jsxs(V,{children:[e.jsx(Z,{data:j,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"count",label:({name:n,percent:s})=>`${n}: ${(s*100).toFixed(0)}%`,children:j.map((n,s)=>e.jsx(_,{fill:n.color},`cell-${s}`))}),e.jsx(y,{formatter:n=>[n,"Collections"],contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"0.5rem"}})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs(a,{className:"border-dairy-200",children:[e.jsxs(i,{children:[e.jsxs(l,{className:"text-dairy-900 flex items-center",children:[e.jsx(C,{className:"h-5 w-5 mr-2 text-dairy-purple"}),"Monthly Revenue Projection"]}),e.jsx(m,{children:"Revenue trends and projections for upcoming months"})]}),e.jsx(o,{children:e.jsx(h,{width:"100%",height:300,children:e.jsxs(ee,{data:R,children:[e.jsx(D,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(M,{dataKey:"month",stroke:"#64748b"}),e.jsx(k,{stroke:"#64748b"}),e.jsx(y,{formatter:n=>[`KSh ${n.toLocaleString()}`,"Revenue"],contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"0.5rem"}}),e.jsx(se,{dataKey:"revenue",fill:"#9333ea",radius:[4,4,0,0]})]})})})]}),e.jsxs(a,{className:"border-dairy-200",children:[e.jsxs(i,{children:[e.jsxs(l,{className:"text-dairy-900 flex items-center",children:[e.jsx(te,{className:"h-5 w-5 mr-2 text-dairy-red"}),"Collection Performance"]}),e.jsx(m,{children:"Comparison with previous periods"})]}),e.jsx(o,{children:e.jsxs("div",{className:"h-full flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsxs("div",{className:"text-3xl font-bold text-dairy-900 mb-2",children:[t.monthOverMonthGrowth>=0?"+":"",t.monthOverMonthGrowth,"%"]}),e.jsxs("p",{className:"text-dairy-600",children:[t.monthOverMonthGrowth>=0?"Growth":"Decline"," from previous month"]})]}),e.jsx("div",{className:"w-full bg-dairy-200 rounded-full h-4",children:e.jsx("div",{className:`h-4 rounded-full ${t.monthOverMonthGrowth>=0?"bg-dairy-green":"bg-red-500"}`,style:{width:`${Math.min(100,Math.abs(t.monthOverMonthGrowth))}%`}})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-dairy-600",children:["Projected next month: ",e.jsxs("span",{className:"font-semibold",children:["KSh ",((f=t.projectedNextMonth)==null?void 0:f.toLocaleString())||"0"]})]})})]})})]})]}),e.jsx("div",{className:"mb-8",children:e.jsxs(a,{className:"border-dairy-200",children:[e.jsxs(i,{children:[e.jsxs(l,{className:"text-dairy-900 flex items-center",children:[e.jsx(w,{className:"h-5 w-5 mr-2 text-dairy-green"}),"Quality Improvement Suggestions"]}),e.jsx(m,{children:"AI-powered recommendations to improve milk quality"})]}),e.jsx(o,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-dairy-50 rounded-lg border border-dairy-200",children:[e.jsx("h3",{className:"font-semibold text-dairy-900 mb-2",children:"Feeding Optimization"}),e.jsx("p",{className:"text-sm text-dairy-600",children:"Increase protein-rich feed by 15% to improve Grade A collections by an estimated 12%"})]}),e.jsxs("div",{className:"p-4 bg-dairy-50 rounded-lg border border-dairy-200",children:[e.jsx("h3",{className:"font-semibold text-dairy-900 mb-2",children:"Milking Hygiene"}),e.jsx("p",{className:"text-sm text-dairy-600",children:"Implement stricter sanitation protocols to reduce Grade C collections by 8%"})]}),e.jsxs("div",{className:"p-4 bg-dairy-50 rounded-lg border border-dairy-200",children:[e.jsx("h3",{className:"font-semibold text-dairy-900 mb-2",children:"Cooling System"}),e.jsx("p",{className:"text-sm text-dairy-600",children:"Upgrade cooling equipment to maintain optimal 2-4Â°C range for better quality preservation"})]})]})})]})})]})]})})};export{ve as default};
