import{e as I,a as K,r as n,z as c,j as e,N as W,W as U,L as j,b as N,M as m,U as G,T as H}from"./index-C6fZJ48e.js";import{C as a,a as t,b as i,d as l,c as b}from"./card-D80GW863.js";import{B as d}from"./badge-Bb0m1QXe.js";import{B as o}from"./button-CjSaidot.js";import{P as p}from"./progress-J4JJxqa_.js";import{A as Y}from"./AdminSidebar-BlxC4_lF.js";import{S as Q,a as Z}from"./avatar-BmR-I4hu.js";import{a as v}from"./ApiService-bGFnA_mg.js";import{C as k}from"./circle-check-big-CorUa3eH.js";import{H as O}from"./sheet-hMc6SWc2.js";import{T as x}from"./trending-up-DypWr_bi.js";import{D as y}from"./dollar-sign-ZMqYMnDH.js";import{T as L}from"./triangle-alert-DiNmet34.js";import{C as D}from"./chart-column-hY8aCTYj.js";import{C as V}from"./circle-x-rQriW1OR.js";import{B as z}from"./bot-CkBzqiOK.js";import{A as J}from"./arrow-right-BdJmqC4G.js";import"./input-ZoKW3yZy.js";import"./separator-DKBG6nYm.js";import"./index-CrhFojRB.js";import"./Combination-D2BFsl2-.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=I("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),we=()=>{const{isAuthenticated:h,user:u,loading:g}=K(),[s,P]=n.useState(null),[R,M]=n.useState([]),[w,_]=n.useState([]),[$,F]=n.useState([]),[T,f]=n.useState(!0),[A,C]=n.useState(null),[ee,se]=n.useState(!1),q=async()=>{try{f(!0);const r=await v.Analytics.getDashboardStats();P(r);const S=await v.Collections.list(100,0);console.log("Collections response:",S),M(S.items.slice(0,5));const B=await v.Farmers.list(100,0);_(B.items.filter(E=>E.kycStatus==="pending")),F([]),c.info("Dashboard data fetched successfully")}catch(r){c.error("Error fetching dashboard data",r),C("Failed to load dashboard data")}finally{f(!1)}};return n.useEffect(()=>{if(c.info("Admin Dashboard page loaded"),console.log("AdminDashboard: Auth state - authLoading:",g,"isAuthenticated:",h,"user:",u),g){console.log("AdminDashboard: Waiting for auth context to finish loading");return}return h&&u?(console.log("AdminDashboard: User is authenticated, fetching data"),q()):(console.log("AdminDashboard: User is not authenticated, redirecting to login"),C("You must be logged in to view this page"),f(!1)),()=>{c.debug("Admin Dashboard page unmounted")}},[h,u,g]),c.time("Dashboard Render"),c.timeEnd("Dashboard Render"),T||g?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):h?A?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsxs("div",{className:"text-red-500 text-center",children:[e.jsxs("p",{children:["Error loading dashboard: ",A]}),e.jsx(o,{onClick:()=>window.location.reload(),className:"mt-4",children:"Retry"})]})}):s?e.jsx(Q,{children:e.jsxs("div",{className:"flex h-screen w-full bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50",children:[e.jsx(Y,{}),e.jsxs(Z,{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("header",{className:"bg-white/90 backdrop-blur-sm border-b border-green-200 px-6 py-4 shadow-sm",role:"banner",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-green-700 to-emerald-700 bg-clip-text text-transparent",children:"Farm Operations Dashboard"}),e.jsxs("p",{className:"text-green-600 flex items-center gap-1 mt-1",children:[e.jsx(U,{className:"h-4 w-4","aria-hidden":"true"}),"Comprehensive dairy farm management & analytics"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(d,{className:"bg-green-100 text-green-700 border-green-200 px-3 py-1",children:[e.jsx(k,{className:"h-3 w-3 mr-1","aria-hidden":"true"}),"System Operational"]}),e.jsx(j,{to:"/",children:e.jsxs(o,{variant:"outline",className:"border-green-300 hover:bg-green-50 text-green-700","aria-label":"Go to Home",children:[e.jsx(O,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),"Home"]})})]})]})}),e.jsxs("main",{id:"main-content",className:"flex-1 overflow-auto p-6",role:"main",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[e.jsxs(a,{className:"border-green-200 hover:shadow-xl transition-all bg-gradient-to-br from-white to-green-50/30",children:[e.jsxs(t,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium text-green-700",children:"Registered Farmers"}),e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-500 rounded-lg flex items-center justify-center",children:e.jsx(N,{className:"h-4 w-4 text-white","aria-hidden":"true"})})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.total_farmers||s.totalFarmers}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(x,{className:"h-3 w-3 mr-1","aria-hidden":"true"}),e.jsx("span",{className:"text-emerald-600",children:"+12%"})," from last month"]})]})]}),e.jsxs(a,{className:"border-green-200 hover:shadow-xl transition-all bg-gradient-to-br from-white to-emerald-50/30",children:[e.jsxs(t,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium text-green-700",children:"Daily Collection"}),e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-500 to-teal-500 rounded-lg flex items-center justify-center",children:e.jsx(m,{className:"h-4 w-4 text-white","aria-hidden":"true"})})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[s.today_liters||s.todayLiters,"L"]}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(x,{className:"h-3 w-3 mr-1","aria-hidden":"true"}),e.jsx("span",{className:"text-emerald-600",children:"+8%"})," from yesterday"]})]})]}),e.jsxs(a,{className:"border-green-200 hover:shadow-xl transition-all bg-gradient-to-br from-white to-teal-50/30",children:[e.jsxs(t,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium text-green-700",children:"Monthly Revenue"}),e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-lg flex items-center justify-center",children:e.jsx(y,{className:"h-4 w-4 text-white","aria-hidden":"true"})})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["KSh ",(s.total_revenue||s.totalRevenue||0).toLocaleString()]}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(x,{className:"h-3 w-3 mr-1","aria-hidden":"true"}),e.jsx("span",{className:"text-emerald-600",children:"+15%"})," growth"]})]})]}),e.jsxs(a,{className:"border-green-200 hover:shadow-xl transition-all bg-gradient-to-br from-white to-orange-50/30",children:[e.jsxs(t,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium text-green-700",children:"Pending Verification"}),e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-500 to-amber-500 rounded-lg flex items-center justify-center",children:e.jsx(L,{className:"h-4 w-4 text-white","aria-hidden":"true"})})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.pending_kyc||s.pendingKYC}),e.jsx("p",{className:"text-xs text-orange-600",children:"Requires immediate attention"})]})]}),e.jsxs(a,{className:"border-green-200 hover:shadow-xl transition-all bg-gradient-to-br from-white to-blue-50/30",children:[e.jsxs(t,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(i,{className:"text-sm font-medium text-green-700",children:"Active Staff"}),e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-lg flex items-center justify-center",children:e.jsx(G,{className:"h-4 w-4 text-white","aria-hidden":"true"})})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"12"}),e.jsxs("p",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(x,{className:"h-3 w-3 mr-1","aria-hidden":"true"}),e.jsx("span",{className:"text-emerald-600",children:"+2"})," from last month"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[e.jsxs(a,{className:"border-green-200 bg-white/70 backdrop-blur-sm",children:[e.jsxs(t,{children:[e.jsxs(i,{className:"text-gray-900 flex items-center",children:[e.jsx(H,{className:"h-5 w-5 mr-2 text-green-600","aria-hidden":"true"}),"Farm Performance Metrics"]}),e.jsx(b,{children:"Weekly production targets and quality achievements"})]}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsxs("span",{className:"text-gray-700 flex items-center",children:[e.jsx(m,{className:"h-4 w-4 mr-1 text-green-600","aria-hidden":"true"}),"Weekly Collection Goal"]}),e.jsxs("span",{className:"text-gray-900 font-medium",children:[s.week_liters||s.weekLiters,"L / 4000L"]})]}),e.jsx(p,{value:(s.week_liters||s.weekLiters)/4e3*100,className:"h-3"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsxs("span",{className:"text-gray-700 flex items-center",children:[e.jsx(D,{className:"h-4 w-4 mr-1 text-emerald-600","aria-hidden":"true"}),"Average Quality Score"]}),e.jsxs("span",{className:"text-gray-900 font-medium",children:[s.avg_quality||s.avgQuality,"/5.0"]})]}),e.jsx(p,{value:(s.avg_quality||s.avgQuality)/5*100,className:"h-3"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsxs("span",{className:"text-gray-700 flex items-center",children:[e.jsx(N,{className:"h-4 w-4 mr-1 text-teal-600","aria-hidden":"true"}),"Farmer Participation"]}),e.jsx("span",{className:"text-gray-900 font-medium",children:"89%"})]}),e.jsx(p,{value:89,className:"h-3"})]})]})})]}),e.jsxs(a,{className:"border-green-200 bg-white/70 backdrop-blur-sm",children:[e.jsxs(t,{children:[e.jsxs(i,{className:"text-gray-900 flex items-center",children:[e.jsx(X,{className:"h-5 w-5 mr-2 text-emerald-600","aria-hidden":"true"}),"Real-time Farm Activity"]}),e.jsx(b,{children:"Latest system activities and important alerts"})]}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 text-sm p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsx(k,{className:"h-4 w-4 text-green-600","aria-hidden":"true"}),e.jsx("span",{className:"text-gray-700",children:"KYC approved for Mary Wanjiku"}),e.jsx("span",{className:"text-green-500 text-xs ml-auto",children:"2m ago"})]}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx(m,{className:"h-4 w-4 text-blue-600","aria-hidden":"true"}),e.jsx("span",{className:"text-gray-700",children:"Collection recorded: 28.5L Grade A"}),e.jsx("span",{className:"text-blue-500 text-xs ml-auto",children:"15m ago"})]}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm p-3 bg-emerald-50 rounded-lg border border-emerald-200",children:[e.jsx(y,{className:"h-4 w-4 text-emerald-600","aria-hidden":"true"}),e.jsx("span",{className:"text-gray-700",children:"Payment processed: KSh 45,408"}),e.jsx("span",{className:"text-emerald-500 text-xs ml-auto",children:"1h ago"})]}),e.jsxs("div",{className:"flex items-center space-x-3 text-sm p-3 bg-orange-50 rounded-lg border border-orange-200",children:[e.jsx(V,{className:"h-4 w-4 text-orange-600","aria-hidden":"true"}),e.jsx("span",{className:"text-gray-700",children:"Quality review required for batch #247"}),e.jsx("span",{className:"text-orange-500 text-xs ml-auto",children:"3h ago"})]})]})})]})]}),e.jsx("div",{className:"mb-8",children:e.jsxs(a,{className:"border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 hover:shadow-xl transition-all",children:[e.jsx(t,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(i,{className:"text-xl font-bold text-blue-900 flex items-center gap-2",children:[e.jsx(z,{className:"h-6 w-6 text-blue-600","aria-hidden":"true"}),"AI-Powered Executive Intelligence"]}),e.jsx(b,{className:"text-blue-700 mt-2",children:"Access advanced analytics, predictive insights, and strategic decision support for optimal farm management"})]}),e.jsx(j,{to:"/admin/ai",children:e.jsxs(o,{className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white","aria-label":"Launch AI Center",children:["Launch AI Center",e.jsx(J,{className:"h-4 w-4 ml-2","aria-hidden":"true"})]})})]})}),e.jsx(l,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/60 rounded-lg",children:[e.jsx(D,{className:"h-5 w-5 text-blue-600","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Strategic Analytics"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Cross-farm performance insights"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/60 rounded-lg",children:[e.jsx(x,{className:"h-5 w-5 text-blue-600","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Predictive Intelligence"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Revenue & production forecasts"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/60 rounded-lg",children:[e.jsx(L,{className:"h-5 w-5 text-blue-600","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Risk Assessment"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Anomaly detection & alerts"})]})]})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(a,{className:"border-green-200 bg-white/70 backdrop-blur-sm lg:col-span-2",children:[e.jsxs(t,{children:[e.jsxs(i,{className:"text-gray-900 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(m,{className:"h-5 w-5 mr-2 text-green-600","aria-hidden":"true"}),"Collection Management"]}),e.jsx(j,{to:"/admin/collections",children:e.jsx(o,{variant:"outline",size:"sm",className:"border-green-300 text-green-700 hover:bg-green-50","aria-label":"View All Collections",children:"View All"})})]}),e.jsx(b,{children:"Monitor and manage milk collection activities across all farmers"})]}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"text-2xl font-bold text-green-700",children:s.today_collections||0}),e.jsx("div",{className:"text-sm text-green-600",children:"Today's Collections"})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-emerald-50 to-teal-50 rounded-lg border border-emerald-200",children:[e.jsxs("div",{className:"text-2xl font-bold text-emerald-700",children:[(s.week_liters||0).toLocaleString(),"L"]}),e.jsx("div",{className:"text-sm text-emerald-600",children:"This Week"})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-teal-50 to-cyan-50 rounded-lg border border-teal-200",children:[e.jsxs("div",{className:"text-2xl font-bold text-teal-700",children:[(s.month_liters||0).toLocaleString(),"L"]}),e.jsx("div",{className:"text-sm text-teal-600",children:"This Month"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Recent Collections"}),R.slice(0,5).map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-green-200 rounded-lg hover:bg-green-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(m,{className:"h-5 w-5 text-green-600","aria-hidden":"true"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.farmer_name||r.farmerName}),e.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(r.timestamp).toLocaleDateString()," • ",r.liters,"L"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(d,{className:"bg-green-100 text-green-700 border-green-200",children:["Grade ",r.quality_grade||r.qualityGrade]}),e.jsxs("span",{className:"text-sm font-medium",children:[r.liters,"L"]})]})]},r.id))]})]})})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs(a,{className:"border-green-200 bg-white/70 backdrop-blur-sm",children:[e.jsx(t,{children:e.jsxs(i,{className:"text-gray-900 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(N,{className:"h-5 w-5 mr-2 text-orange-600","aria-hidden":"true"}),"Farmer Applications"]}),e.jsx(d,{className:"bg-orange-100 text-orange-700 border-orange-200",children:w.length})]})}),e.jsxs(l,{children:[e.jsx("div",{className:"space-y-3",children:w.slice(0,3).map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-green-200 rounded-lg bg-gradient-to-r from-green-50 to-emerald-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-sm text-gray-600",children:r.phone})]}),e.jsx(d,{variant:"outline",className:"border-orange-300 text-orange-700",children:"Review"})]},r.id))}),e.jsx(j,{to:"/admin/kyc",children:e.jsx(o,{className:"w-full mt-4 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700","aria-label":"Process Applications",children:"Process Applications"})})]})]}),e.jsxs(a,{className:"border-green-200 bg-white/70 backdrop-blur-sm",children:[e.jsx(t,{children:e.jsxs(i,{className:"text-gray-900 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(y,{className:"h-5 w-5 mr-2 text-blue-600"}),"Staff Performance"]}),e.jsx(d,{className:"bg-blue-100 text-blue-700 border-blue-200",children:"12 Active"})]})}),e.jsxs(l,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border border-green-200 rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"John Mwangi"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Zone A - 24 collections"})]}),e.jsx(d,{variant:"outline",className:"border-blue-300 text-blue-700",children:"Active"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border border-green-200 rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Sarah Kimani"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Zone B - 18 collections"})]}),e.jsx(d,{variant:"outline",className:"border-blue-300 text-blue-700",children:"Active"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border border-green-200 rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Peter Ochieng"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Zone C - 21 collections"})]}),e.jsx(d,{variant:"outline",className:"border-blue-300 text-blue-700",children:"Active"})]})]}),e.jsx(o,{className:"w-full mt-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700","aria-label":"Manage Staff",children:"Manage Staff"})]})]})]})]})]})]})]})}):e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("p",{children:"No data available"})}):e.jsx(W,{to:"/login?role=admin",replace:!0})};export{we as default};
